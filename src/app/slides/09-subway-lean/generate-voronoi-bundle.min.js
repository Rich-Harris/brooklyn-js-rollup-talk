function d3_functor(o){return"function"==typeof o?o:function(){return o}}function d3_geom_clipLine(o,e,r,i){return function(n){var t,_=n.a,d=n.b,g=_.x,a=_.y,l=d.x,s=d.y,c=0,v=1,m=l-g,f=s-a;if(t=o-g,m||!(t>0)){if(t/=m,0>m){if(c>t)return;v>t&&(v=t)}else if(m>0){if(t>v)return;t>c&&(c=t)}if(t=r-g,m||!(0>t)){if(t/=m,0>m){if(t>v)return;t>c&&(c=t)}else if(m>0){if(c>t)return;v>t&&(v=t)}if(t=e-a,f||!(t>0)){if(t/=f,0>f){if(c>t)return;v>t&&(v=t)}else if(f>0){if(t>v)return;t>c&&(c=t)}if(t=i-a,f||!(0>t)){if(t/=f,0>f){if(t>v)return;t>c&&(c=t)}else if(f>0){if(c>t)return;v>t&&(v=t)}return c>0&&(n.a={x:g+c*m,y:a+c*f}),1>v&&(n.b={x:g+v*m,y:a+v*f}),n}}}}}}function d3_geom_voronoiBeach(){d3_geom_voronoiRedBlackNode(this),this.edge=this.site=this.circle=null}function d3_geom_voronoiCreateBeach(o){var e=d3_geom_voronoiBeachPool.pop()||new d3_geom_voronoiBeach;return e.site=o,e}function d3_geom_voronoiDetachBeach(o){d3_geom_voronoiDetachCircle(o),d3_geom_voronoiBeaches.remove(o),d3_geom_voronoiBeachPool.push(o),d3_geom_voronoiRedBlackNode(o)}function d3_geom_voronoiRemoveBeach(o){var e=o.circle,r=e.x,i=e.cy,n={x:r,y:i},t=o.P,_=o.N,d=[o];d3_geom_voronoiDetachBeach(o);for(var g=t;g.circle&&abs(r-g.circle.x)<ε&&abs(i-g.circle.cy)<ε;)t=g.P,d.unshift(g),d3_geom_voronoiDetachBeach(g),g=t;d.unshift(g),d3_geom_voronoiDetachCircle(g);for(var a=_;a.circle&&abs(r-a.circle.x)<ε&&abs(i-a.circle.cy)<ε;)_=a.N,d.push(a),d3_geom_voronoiDetachBeach(a),a=_;d.push(a),d3_geom_voronoiDetachCircle(a);var l,s=d.length;for(l=1;s>l;++l)a=d[l],g=d[l-1],d3_geom_voronoiSetEdgeEnd(a.edge,g.site,a.site,n);g=d[0],a=d[s-1],a.edge=d3_geom_voronoiCreateEdge(g.site,a.site,null,n),d3_geom_voronoiAttachCircle(g),d3_geom_voronoiAttachCircle(a)}function d3_geom_voronoiAddBeach(o){for(var e,r,i,n,t=o.x,_=o.y,d=d3_geom_voronoiBeaches._;d;)if(i=d3_geom_voronoiLeftBreakPoint(d,_)-t,i>ε)d=d.L;else{if(n=t-d3_geom_voronoiRightBreakPoint(d,_),!(n>ε)){i>-ε?(e=d.P,r=d):n>-ε?(e=d,r=d.N):e=r=d;break}if(!d.R){e=d;break}d=d.R}var g=d3_geom_voronoiCreateBeach(o);if(d3_geom_voronoiBeaches.insert(e,g),e||r){if(e===r)return d3_geom_voronoiDetachCircle(e),r=d3_geom_voronoiCreateBeach(e.site),d3_geom_voronoiBeaches.insert(g,r),g.edge=r.edge=d3_geom_voronoiCreateEdge(e.site,g.site),d3_geom_voronoiAttachCircle(e),void d3_geom_voronoiAttachCircle(r);if(!r)return void(g.edge=d3_geom_voronoiCreateEdge(e.site,g.site));d3_geom_voronoiDetachCircle(e),d3_geom_voronoiDetachCircle(r);var a=e.site,l=a.x,s=a.y,c=o.x-l,v=o.y-s,m=r.site,f=m.x-l,u=m.y-s,h=2*(c*u-v*f),C=c*c+v*v,y=f*f+u*u,R={x:(u*C-v*y)/h+l,y:(c*y-f*C)/h+s};d3_geom_voronoiSetEdgeEnd(r.edge,a,m,R),g.edge=d3_geom_voronoiCreateEdge(a,o,null,R),r.edge=d3_geom_voronoiCreateEdge(o,m,null,R),d3_geom_voronoiAttachCircle(e),d3_geom_voronoiAttachCircle(r)}}function d3_geom_voronoiLeftBreakPoint(o,e){var r=o.site,i=r.x,n=r.y,t=n-e;if(!t)return i;var _=o.P;if(!_)return-(1/0);r=_.site;var d=r.x,g=r.y,a=g-e;if(!a)return d;var l=d-i,s=1/t-1/a,c=l/a;return s?(-c+Math.sqrt(c*c-2*s*(l*l/(-2*a)-g+a/2+n-t/2)))/s+i:(i+d)/2}function d3_geom_voronoiRightBreakPoint(o,e){var r=o.N;if(r)return d3_geom_voronoiLeftBreakPoint(r,e);var i=o.site;return i.y===e?i.x:1/0}function d3_geom_voronoiCell(o){this.site=o,this.edges=[]}function d3_geom_voronoiCloseCells(o){for(var e,r,i,n,t,_,d,g,a,l,s=o[0][0],c=o[1][0],v=o[0][1],m=o[1][1],f=d3_geom_voronoiCells,u=f.length;u--;)if(t=f[u],t&&t.prepare())for(d=t.edges,g=d.length,_=0;g>_;)l=d[_].end(),i=l.x,n=l.y,a=d[++_%g].start(),e=a.x,r=a.y,(abs(i-e)>ε||abs(n-r)>ε)&&(d.splice(_,0,new d3_geom_voronoiHalfEdge(d3_geom_voronoiCreateBorderEdge(t.site,l,abs(i-s)<ε&&m-n>ε?{x:s,y:abs(e-s)<ε?r:m}:abs(n-m)<ε&&c-i>ε?{x:abs(r-m)<ε?e:c,y:m}:abs(i-c)<ε&&n-v>ε?{x:c,y:abs(e-c)<ε?r:v}:abs(n-v)<ε&&i-s>ε?{x:abs(r-v)<ε?e:s,y:v}:null),t.site,null)),++g)}function d3_geom_voronoiHalfEdgeOrder(o,e){return e.angle-o.angle}function d3_geom_voronoiCircle(){d3_geom_voronoiRedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null}function d3_geom_voronoiAttachCircle(o){var e=o.P,r=o.N;if(e&&r){var i=e.site,n=o.site,t=r.site;if(i!==t){var _=n.x,d=n.y,g=i.x-_,a=i.y-d,l=t.x-_,s=t.y-d,c=2*(g*s-a*l);if(!(c>=-ε2)){var v=g*g+a*a,m=l*l+s*s,f=(s*v-a*m)/c,u=(g*m-l*v)/c,s=u+d,h=d3_geom_voronoiCirclePool.pop()||new d3_geom_voronoiCircle;h.arc=o,h.site=n,h.x=f+_,h.y=s+Math.sqrt(f*f+u*u),h.cy=s,o.circle=h;for(var C=null,y=d3_geom_voronoiCircles._;y;)if(h.y<y.y||h.y===y.y&&h.x<=y.x){if(!y.L){C=y.P;break}y=y.L}else{if(!y.R){C=y;break}y=y.R}d3_geom_voronoiCircles.insert(C,h),C||(d3_geom_voronoiFirstCircle=h)}}}}function d3_geom_voronoiDetachCircle(o){var e=o.circle;e&&(e.P||(d3_geom_voronoiFirstCircle=e.N),d3_geom_voronoiCircles.remove(e),d3_geom_voronoiCirclePool.push(e),d3_geom_voronoiRedBlackNode(e),o.circle=null)}function d3_geom_voronoiClipEdges(o){for(var e,r=d3_geom_voronoiEdges,i=d3_geom_clipLine(o[0][0],o[0][1],o[1][0],o[1][1]),n=r.length;n--;)e=r[n],(!d3_geom_voronoiConnectEdge(e,o)||!i(e)||abs(e.a.x-e.b.x)<ε&&abs(e.a.y-e.b.y)<ε)&&(e.a=e.b=null,r.splice(n,1))}function d3_geom_voronoiConnectEdge(o,e){var r=o.b;if(r)return!0;var i,n,t=o.a,_=e[0][0],d=e[1][0],g=e[0][1],a=e[1][1],l=o.l,s=o.r,c=l.x,v=l.y,m=s.x,f=s.y,u=(c+m)/2,h=(v+f)/2;if(f===v){if(_>u||u>=d)return;if(c>m){if(t){if(t.y>=a)return}else t={x:u,y:g};r={x:u,y:a}}else{if(t){if(t.y<g)return}else t={x:u,y:a};r={x:u,y:g}}}else if(i=(c-m)/(f-v),n=h-i*u,-1>i||i>1)if(c>m){if(t){if(t.y>=a)return}else t={x:(g-n)/i,y:g};r={x:(a-n)/i,y:a}}else{if(t){if(t.y<g)return}else t={x:(a-n)/i,y:a};r={x:(g-n)/i,y:g}}else if(f>v){if(t){if(t.x>=d)return}else t={x:_,y:i*_+n};r={x:d,y:i*d+n}}else{if(t){if(t.x<_)return}else t={x:d,y:i*d+n};r={x:_,y:i*_+n}}return o.a=t,o.b=r,!0}function d3_geom_voronoiEdge(o,e){this.l=o,this.r=e,this.a=this.b=null}function d3_geom_voronoiCreateEdge(o,e,r,i){var n=new d3_geom_voronoiEdge(o,e);return d3_geom_voronoiEdges.push(n),r&&d3_geom_voronoiSetEdgeEnd(n,o,e,r),i&&d3_geom_voronoiSetEdgeEnd(n,e,o,i),d3_geom_voronoiCells[o.i].edges.push(new d3_geom_voronoiHalfEdge(n,o,e)),d3_geom_voronoiCells[e.i].edges.push(new d3_geom_voronoiHalfEdge(n,e,o)),n}function d3_geom_voronoiCreateBorderEdge(o,e,r){var i=new d3_geom_voronoiEdge(o,null);return i.a=e,i.b=r,d3_geom_voronoiEdges.push(i),i}function d3_geom_voronoiSetEdgeEnd(o,e,r,i){o.a||o.b?o.l===r?o.b=i:o.a=i:(o.a=i,o.l=e,o.r=r)}function d3_geom_voronoiHalfEdge(o,e,r){var i=o.a,n=o.b;this.edge=o,this.site=e,this.angle=r?Math.atan2(r.y-e.y,r.x-e.x):o.l===e?Math.atan2(n.x-i.x,i.y-n.y):Math.atan2(i.x-n.x,n.y-i.y)}function d3_geom_voronoiRedBlackTree(){this._=null}function d3_geom_voronoiRedBlackNode(o){o.U=o.C=o.L=o.R=o.P=o.N=null}function d3_geom_voronoiRedBlackRotateLeft(o,e){var r=e,i=e.R,n=r.U;n?n.L===r?n.L=i:n.R=i:o._=i,i.U=n,r.U=i,r.R=i.L,r.R&&(r.R.U=r),i.L=r}function d3_geom_voronoiRedBlackRotateRight(o,e){var r=e,i=e.L,n=r.U;n?n.L===r?n.L=i:n.R=i:o._=i,i.U=n,r.U=i,r.L=i.R,r.L&&(r.L.U=r),i.R=r}function d3_geom_voronoiRedBlackFirst(o){for(;o.L;)o=o.L;return o}function d3_geom_voronoi(o,e){var r,i,n,t=o.sort(d3_geom_voronoiVertexOrder).pop();for(d3_geom_voronoiEdges=[],d3_geom_voronoiCells=new Array(o.length),d3_geom_voronoiBeaches=new d3_geom_voronoiRedBlackTree,d3_geom_voronoiCircles=new d3_geom_voronoiRedBlackTree;;)if(n=d3_geom_voronoiFirstCircle,t&&(!n||t.y<n.y||t.y===n.y&&t.x<n.x))(t.x!==r||t.y!==i)&&(d3_geom_voronoiCells[t.i]=new d3_geom_voronoiCell(t),d3_geom_voronoiAddBeach(t),r=t.x,i=t.y),t=o.pop();else{if(!n)break;d3_geom_voronoiRemoveBeach(n.arc)}e&&(d3_geom_voronoiClipEdges(e),d3_geom_voronoiCloseCells(e));var _={cells:d3_geom_voronoiCells,edges:d3_geom_voronoiEdges};return d3_geom_voronoiBeaches=d3_geom_voronoiCircles=d3_geom_voronoiEdges=d3_geom_voronoiCells=null,_}function d3_geom_voronoiVertexOrder(o,e){return e.y-o.y||e.x-o.x}function d3_geom_pointX(o){return o[0]}function d3_geom_pointY(o){return o[1]}function d3_geom_voronoiTriangleArea(o,e,r){return(o.x-r.x)*(e.y-o.y)-(o.x-e.x)*(r.y-o.y)}function generateVoronoiLayout(o){const e=d3$geom$voronoi(o.map(function(o){return[o.x,o.y]}));return e.map(function(e,r){return{index:r,stop:o[r],path:"M"+e.join("L")+"L"+e[0]+"Z"}})}var ε=1e-6,ε2=ε*ε,abs=Math.abs,d3_geom_voronoiEdges,d3_geom_voronoiCells,d3_geom_voronoiBeaches,d3_geom_voronoiBeachPool=[],d3_geom_voronoiFirstCircle,d3_geom_voronoiCircles,d3_geom_voronoiCirclePool=[];d3_geom_voronoiCell.prototype.prepare=function(){for(var o,e=this.edges,r=e.length;r--;)o=e[r].edge,o.b&&o.a||e.splice(r,1);return e.sort(d3_geom_voronoiHalfEdgeOrder),e.length},d3_geom_voronoiHalfEdge.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},d3_geom_voronoiRedBlackTree.prototype={insert:function(o,e){var r,i,n;if(o){if(e.P=o,e.N=o.N,o.N&&(o.N.P=e),o.N=e,o.R){for(o=o.R;o.L;)o=o.L;o.L=e}else o.R=e;r=o}else this._?(o=d3_geom_voronoiRedBlackFirst(this._),e.P=null,e.N=o,o.P=o.L=e,r=o):(e.P=e.N=null,this._=e,r=null);for(e.L=e.R=null,e.U=r,e.C=!0,o=e;r&&r.C;)i=r.U,r===i.L?(n=i.R,n&&n.C?(r.C=n.C=!1,i.C=!0,o=i):(o===r.R&&(d3_geom_voronoiRedBlackRotateLeft(this,r),o=r,r=o.U),r.C=!1,i.C=!0,d3_geom_voronoiRedBlackRotateRight(this,i))):(n=i.L,n&&n.C?(r.C=n.C=!1,i.C=!0,o=i):(o===r.L&&(d3_geom_voronoiRedBlackRotateRight(this,r),o=r,r=o.U),r.C=!1,i.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,i))),r=o.U;this._.C=!1},remove:function(o){o.N&&(o.N.P=o.P),o.P&&(o.P.N=o.N),o.N=o.P=null;var e,r,i,n=o.U,t=o.L,_=o.R;if(r=t?_?d3_geom_voronoiRedBlackFirst(_):t:_,n?n.L===o?n.L=r:n.R=r:this._=r,t&&_?(i=r.C,r.C=o.C,r.L=t,t.U=r,r!==_?(n=r.U,r.U=o.U,o=r.R,n.L=o,r.R=_,_.U=r):(r.U=n,n=r,o=r.R)):(i=o.C,o=r),o&&(o.U=n),!i){if(o&&o.C)return void(o.C=!1);do{if(o===this._)break;if(o===n.L){if(e=n.R,e.C&&(e.C=!1,n.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,n),e=n.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,d3_geom_voronoiRedBlackRotateRight(this,e),e=n.R),e.C=n.C,n.C=e.R.C=!1,d3_geom_voronoiRedBlackRotateLeft(this,n),o=this._;break}}else if(e=n.L,e.C&&(e.C=!1,n.C=!0,d3_geom_voronoiRedBlackRotateRight(this,n),e=n.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,e),e=n.L),e.C=n.C,n.C=e.L.C=!1,d3_geom_voronoiRedBlackRotateRight(this,n),o=this._;break}e.C=!0,o=n,n=n.U}while(!o.C);o&&(o.C=!1)}}};var d3$geom$voronoi;d3$geom$voronoi=function(o){function e(o){var e=new Array(o.length),i=d[0][0],n=d[0][1],t=d[1][0],_=d[1][1];return d3_geom_voronoi(r(o),d).cells.forEach(function(r,d){var g=r.edges,a=r.site,l=e[d]=g.length?g.map(function(o){var e=o.start();return[e.x,e.y]}):a.x>=i&&a.x<=t&&a.y>=n&&a.y<=_?[[i,_],[t,_],[t,n],[i,n]]:[];l.point=o[d]}),e}function r(o){return o.map(function(o,e){return{x:Math.round(t(o,e)/ε)*ε,y:Math.round(_(o,e)/ε)*ε,i:e}})}var i=d3_geom_pointX,n=d3_geom_pointY,t=i,_=n,d=d3_geom_voronoiClipExtent;return o?e(o):(e.links=function(o){return d3_geom_voronoi(r(o)).edges.filter(function(o){return o.l&&o.r}).map(function(e){return{source:o[e.l.i],target:o[e.r.i]}})},e.triangles=function(o){var e=[];return d3_geom_voronoi(r(o)).cells.forEach(function(r,i){for(var n,t,_=r.site,d=r.edges.sort(d3_geom_voronoiHalfEdgeOrder),g=-1,a=d.length,l=d[a-1].edge,s=l.l===_?l.r:l.l;++g<a;)n=l,t=s,l=d[g].edge,s=l.l===_?l.r:l.l,i<t.i&&i<s.i&&d3_geom_voronoiTriangleArea(_,t,s)<0&&e.push([o[i],o[t.i],o[s.i]])}),e},e.x=function(o){return arguments.length?(t=d3_functor(i=o),e):i},e.y=function(o){return arguments.length?(_=d3_functor(n=o),e):n},e.clipExtent=function(o){return arguments.length?(d=null==o?d3_geom_voronoiClipExtent:o,e):d===d3_geom_voronoiClipExtent?null:d},e.size=function(o){return arguments.length?e.clipExtent(o&&[[0,0],o]):d===d3_geom_voronoiClipExtent?null:d&&d[1]},e)};var d3_geom_voronoiClipExtent=[[-1e6,-1e6],[1e6,1e6]];module.exports=generateVoronoiLayout;